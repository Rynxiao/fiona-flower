var $fionaBar=$("#fionaBar"),$fionaBarCaret=$(".fiona-bar-caret"),$album=$("#album"),$listItem=$("#album .fiona-list-item"),$fionaList=$("#fionaList"),$fionaMe=$("#fionaMe"),$goBack=$("#goBack"),$sliderClose=$(".fiona-slider-close"),$sliderWrapper=$(".fiona-slider-wrapper"),isFixed=!1,slider=!1,previousScrollTop=0,pageSize=9,page=1,albumList=Config.albumList,albumLength=albumList.length,imagePath="images/resources/",coverPath=imagePath+"cover/",total=Math.ceil(albumLength/pageSize);function fixedBar(i){105<i&&!isFixed&&($fionaBar.css({position:"fixed",top:0,boxShadow:"0 2px 9px rgba(175, 173, 173, 0.42)"}),isFixed=!0),i<=105&&isFixed&&($fionaBar.css({position:"absolute",top:"105px",boxShadow:"none"}),isFixed=!1)}function appendNewAlbum(){var i=(page-1)*pageSize,a=i+pageSize,e='<li class="fiona-list-item"><a href="javascript:void(0);"><div class="fiona-item-mask"><p>{{desc1}}</p><p>{{desc2}}</p></div></a></li>',o=[];albumLength<=a&&(a=albumLength);for(var t=i;t<a;t++){var s=albumList[t],n=$(e.replace(/\{\{desc1\}\}/g,s.desc1).replace(/\{\{desc2\}\}/g,s.desc2));n.find("a").css("background-image","url('"+coverPath+s.src+"')"),o.push(n)}$album.append(o),page++}function loadImgOnScroll(i){$album.offset().top+$album.height()<=i+$(window).height()&&appendNewAlbum()}function goToBack(){var i=$(document).scrollTop(),a=null;i<=0?(i=0,$(document).scrollTop(0),cancelAnimationFrame(a)):(i-=30,$(document).scrollTop(i),a=requestAnimationFrame(goToBack))}function fixWindow(){previousScrollTop=$(document).scrollTop(),$(".fiona-container").addClass("fixed")}function resetWindow(){$(".fiona-container").removeClass("fixed"),$(document).scrollTop(previousScrollTop)}document.addEventListener("scroll",function(i){if(slider)return i.preventDefault(),!1;var a=$(document).scrollTop();fixedBar(a),page<=total&&loadImgOnScroll(a)}),$fionaBar.on("click",".fiona-bar-item",function(i){var a=$(this);a.addClass("active").siblings(".fiona-bar-item").removeClass("active"),a.hasClass("last")?($fionaBarCaret.css("left","75%"),$fionaMe.show().animate({opacity:1}),$fionaList.hide().css("opacity",0)):($fionaBarCaret.css("left","25%"),$fionaMe.hide().css("opacity",0),$fionaList.show().animate({opacity:1}))}),appendNewAlbum(),$goBack.on("click",goToBack),$album.on("click","li",function(){var i=$(this),a=i.offset(),e=i.outerWidth(),o=i.outerHeight();$sliderWrapper.css({left:a.left+"px",top:a.top-$(document).scrollTop()+"px",width:e+"px",height:o+"px",opacity:0,display:"block"}),slider=!0,fixWindow(),$sliderWrapper.animate({left:0,top:0,width:"100%",height:"100%",opacity:1},300,"swing")}),$sliderClose.on("click",function(){slider=!1,$sliderWrapper.hide(),resetWindow()});